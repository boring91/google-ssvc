from typing import Optional, Literal

from evaluation_units.evaluation_unit import EvaluationResult
from evaluation_units.state_of_exploitation.base_state_of_exploitation_evaluation_unit import \
    BaseStateOfExploitationEvaluationUnit
from llm.llm_evaluators.exploitation_llm_evaluator import ExploitationLlmEvaluator


class GeminiStateOfExploitationEvaluationUnit(BaseStateOfExploitationEvaluationUnit):
    def _process_evaluation(self, cve_id: str) -> Optional[EvaluationResult[Literal['active', 'poc', 'none']]]:
        llm_evaluator = ExploitationLlmEvaluator('gemini')
        result = llm_evaluator.evaluate(cve_id)
        return EvaluationResult(result['assessment'], result['confidence'], result['justification'])
