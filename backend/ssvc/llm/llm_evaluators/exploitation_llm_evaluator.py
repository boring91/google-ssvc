from ssvc.llm.llm_evaluators.base_llm_evaluator import BaseLlmEvaluator


class ExploitationLlmEvaluator(BaseLlmEvaluator):

    @staticmethod
    def name() -> str:
        return 'state_of_expolitation'

    def _get_question(self) -> str:
        return "What is the State of Exploitation of the given CVE?"

    def _get_description(self) -> str:
        return """You should only answer with one of the 
                   following: "none", "poc", or "active". Here is the methodology you should follow to determine how 
                   to categorize a CVE into one of these answers:
                       "none": No Evidence of the active exploitation found.
                       "poc": To choose this value, one of the following criteria must be met:
                           1. Private proofs of exploitation have been detected, which have yet to be shared publicly.
                           2. There are rumours in the cybersecurity community about the exploitation of this 
                              vulnerability.
                           3. Proofs of concept have been found in spaces such as Metasploit.
                           4. The methodology for exploiting the vulnerability is known.
                       "active": Reliable and confirmed evidence of real exploitation of the vulnerability by attackers
                        has been collected and is publicly reported. Do NOT report a CVE as active unless it has been
                        used by attackers. If a CVE has been reported to have a publicly available 
                        proof of concept (poc) that may lead to a potential exploitation, do not evaluate it as 
                        "active" as it should be "poc" in this case. If there are indications that the CVE may have been
                        used without any hard evidence, do not evaluate it as "active", it should be "poc"."""
